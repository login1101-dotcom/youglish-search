<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Oxford + Cambridge + æ­£è¦åŒ–</title>
  <style>
    body { font-family: sans-serif; margin:20px; }
    h1 { font-size: 18px; }
    table { border-collapse: collapse; width: 100%; margin-top: 12px; }
    th, td { border: 1px solid #ccc; padding: 8px; vertical-align: top; }
    th { background: #f3f4f6; }
  </style>
</head>
<body>
  <h1>IPA (Oxford / Cambridge / æ­£è¦åŒ–)</h1>
  <input id="word" value="cat">
  <button onclick="lookup()">æ¤œç´¢</button>

  <table>
    <thead>
      <tr>
        <th>Oxford</th>
        <th>Cambridge</th>
        <th>æ­£è¦åŒ–</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td id="oxfordCell">â€”</td>
        <td id="cambridgeCell">â€”</td>
        <td id="normalizedCell">â€”</td>
      </tr>
    </tbody>
  </table>

  <script>
    const OXFORD_APP_ID = "ã‚ãªãŸã®APP_ID";
    const OXFORD_APP_KEY = "ã‚ãªãŸã®APP_KEY";

    async function fetchOxford(word) {
      const url = `https://od-api.oxforddictionaries.com/api/v2/entries/en-us/${word.toLowerCase()}`;
      try {
        const res = await fetch(url, {
          headers: { "app_id": OXFORD_APP_ID, "app_key": OXFORD_APP_KEY }
        });
        if (!res.ok) return "â€”";
        const data = await res.json();
        const out = [];
        (data.results||[]).forEach(r=>{
          (r.lexicalEntries||[]).forEach(lex=>{
            (lex.entries||[]).forEach(e=>{
              (e.pronunciations||[]).forEach(p=>{
                if(p.phoneticSpelling) out.push(p.phoneticSpelling);
              });
            });
          });
        });
        return [...new Set(out)].join(" | ") || "â€”";
      } catch(e) { return "â€”"; }
    }

    async function fetchCambridge(word) {
      // å…¬å¼APIãªã— â†’ ãƒªãƒ³ã‚¯ã‚’è¡¨ç¤ºã™ã‚‹å½¢ã«ã™ã‚‹
      return `ğŸ”— <a href="https://dictionary.cambridge.org/dictionary/english/${word}" target="_blank">Cambridgeã§è¦‹ã‚‹</a>`;
    }

    function normalizeIPA(ipa) {
      if (!ipa || ipa==="â€”") return "â€”";
      let s = ipa;
      if (/Ã¦/.test(s)) return "short a";
      if (/É‘|É’|É”/.test(s)) return "short o";
      if (/Éª/.test(s)) return "short i";
      if (/ÊŠ/.test(s)) return "short oo";
      if (/ÊŒ/.test(s)) return "short u";
      if (/É™/.test(s)) return "schwa";
      if (/É‘Ër|É‘r/.test(s)) return "ar sound";
      if (/É”Ër|É”r/.test(s)) return "or sound";
      if (/Éš|É|É™r/.test(s)) return "er sound";
      if (/ÊŠÉ™/.test(s)) return "short oo + er sound";
      if (/ÉªÉ™/.test(s)) return "short i + er sound";
      if (/eÉ™/.test(s)) return "short e + er sound";
      return s;
    }

    async function lookup() {
      const word = document.getElementById("word").value.trim();
      if (!word) return;
      document.getElementById("oxfordCell").textContent = "â€¦";
      document.getElementById("cambridgeCell").textContent = "â€¦";
      document.getElementById("normalizedCell").textContent = "â€¦";

      const oxford = await fetchOxford(word);
      document.getElementById("oxfordCell").textContent = oxford;
      const cambridge = await fetchCambridge(word);
      document.getElementById("cambridgeCell").innerHTML = cambridge;
      document.getElementById("normalizedCell").textContent = normalizeIPA(oxford);
    }
  </script>
</body>
</html>
